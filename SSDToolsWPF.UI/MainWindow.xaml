<Window x:Class="SSDToolsWPF.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SSDToolsWPF.UI"
        mc:Ignorable="d"
        Title="SSD One-Stop Tool"
        Height="768" Width="1024"
        MinHeight="700" MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource VS_BackgroundBrush}"
        Foreground="{StaticResource VS_TextBrush}">

  <Window.Resources>
    <!-- Converters -->
    <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    <local:InverseBooleanConverter x:Key="InverseBoolConverter"/>
  </Window.Resources>

  <Grid Margin="15">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="240" />
      <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>

    <Grid.RowDefinitions>
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <!-- Left panel - Wrapped in Border for modern look -->
    <Border Grid.Column="0" 
            Background="{StaticResource VS_BackgroundDarkBrush}"
            BorderBrush="{StaticResource VS_BorderBrush}"
            BorderThickness="0,0,1,0"
            Padding="10">
      <ScrollViewer VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled">
        <StackPanel>
          <TextBlock Text="DRIVES" 
                     FontWeight="Bold" 
                     FontSize="11"
                     Foreground="{StaticResource VS_TextSecondaryBrush}"
                     Margin="0,0,0,8"/>
          <ListBox ItemsSource="{Binding Drives}"
                   SelectedItem="{Binding SelectedDrive}"
                   DisplayMemberPath="Letter"
                   Style="{StaticResource ModernListBox}"
                   Height="100"
                   Margin="0,0,0,15" />

          <TextBlock Text="OPERATIONS" 
                     FontWeight="Bold" 
                     FontSize="11"
                     Foreground="{StaticResource VS_TextSecondaryBrush}"
                     Margin="0,5,0,8"/>

          <Button Content="Repair Optimize Service" 
                  Margin="0,0,0,6" 
                  Height="32"
                  Style="{StaticResource ModernButton}"
                  Click="BtnRepairService_Click"
                  IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"/>
          <Button Content="Check TRIM Status" 
                  Margin="0,0,0,6" 
                  Height="32"
                  Style="{StaticResource ModernButton}"
                  Click="BtnCheckTrim_Click"
                  IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"/>
          <Button Content="Test TRIM on All Drives" 
                  Margin="0,0,0,6" 
                  Height="32"
                  Style="{StaticResource AccentButton}"
                  Click="BtnTestAll_Click"
                  IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"/>
          <Button Content="Setup Monthly Tasks" 
                  Margin="0,0,0,6" 
                  Height="32"
                  Style="{StaticResource ModernButton}"
                  Click="BtnSetupTasks_Click"
                  IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"/>
          <Button Content="Manual TRIM (Selected)" 
                  Margin="0,0,0,6" 
                  Height="32"
                  Style="{StaticResource ModernButton}"
                  Click="BtnManualTrim_Click"
                  IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"/>
          <Button Content="Show Status Summary" 
                  Margin="0,0,0,6" 
                  Height="32"
                  Style="{StaticResource ModernButton}"
                  Click="BtnStatus_Click"
                  IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"/>

          <Separator Margin="0,10,0,10" Background="{StaticResource VS_BorderBrush}"/>

          <Button Content="Refresh Drive List" 
                  Margin="0,0,0,6" 
                  Height="32"
                  Style="{StaticResource ModernButton}"
                  Click="BtnRefreshDrives_Click"
                  IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"/>

          <Separator Margin="0,10,0,10" Background="{StaticResource VS_BorderBrush}"/>

          <Button Content="About" 
                  Margin="0,0,0,6" 
                  Height="32"
                  Style="{StaticResource ModernButton}"
                  Click="BtnAbout_Click"/>
          <Button Content="Exit" 
                  Margin="0,0,0,0" 
                  Height="32"
                  Style="{StaticResource ModernButton}"
                  Click="BtnExit_Click"/>
        </StackPanel>
      </ScrollViewer>
    </Border>

    <!-- Right panel -->
    <Border Grid.Column="1" 
            Background="{StaticResource VS_BackgroundBrush}"
            Padding="15,0,0,0">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto" />
          <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" 
                   Text="LOG / STATUS" 
                   FontWeight="Bold" 
                   FontSize="11"
                   Foreground="{StaticResource VS_TextSecondaryBrush}"
                   Margin="0,0,0,8"/>
        
        <Border Grid.Row="1"
                BorderBrush="{StaticResource VS_BorderBrush}"
                BorderThickness="1"
                Background="{StaticResource VS_BackgroundDarkBrush}">
          <ScrollViewer VerticalScrollBarVisibility="Auto"
                        HorizontalScrollBarVisibility="Auto">
            <TextBox x:Name="LogTextBox"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     Style="{StaticResource ModernTextBox}"
                     FontFamily="Consolas"
                     FontSize="12"
                     IsReadOnly="True"
                     BorderThickness="0"
                     Padding="8" />
          </ScrollViewer>
        </Border>
      </Grid>
    </Border>

    <!-- Busy Indicator Overlay -->
    <Border Grid.Column="0" Grid.ColumnSpan="2"
            Background="#DD000000"
            Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}}">
      <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid Width="140" Height="140">
          <!-- Modern Spinning circle -->
          <Ellipse Width="120" Height="120" 
                   Stroke="{StaticResource VS_SuccessBrush}" 
                   StrokeThickness="4"
                   StrokeDashArray="8 4"
                   Fill="Transparent"
                   Panel.ZIndex="0"
                   RenderTransformOrigin="0.5,0.5">
            <Ellipse.RenderTransform>
              <RotateTransform x:Name="SpinnerRotation" Angle="0" />
            </Ellipse.RenderTransform>
            <Ellipse.Triggers>
              <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard>
                  <Storyboard RepeatBehavior="Forever">
                    <DoubleAnimation Storyboard.TargetName="SpinnerRotation"
                                     Storyboard.TargetProperty="Angle"
                                     From="0" To="360" Duration="0:0:1.5" />
                  </Storyboard>
                </BeginStoryboard>
              </EventTrigger>
            </Ellipse.Triggers>
          </Ellipse>
          <!-- Percentage display -->
          <TextBlock Text="{Binding ProgressPercentage}" 
                     FontSize="32" 
                     FontWeight="Bold"
                     Foreground="{StaticResource VS_SuccessBrush}"
                     HorizontalAlignment="Center"
                     VerticalAlignment="Center"
                     TextAlignment="Center"
                     Panel.ZIndex="1"/>
        </Grid>
        <TextBlock Text="{Binding BusyMessage}" 
                   FontSize="16" 
                   FontWeight="SemiBold"
                   Foreground="{StaticResource VS_TextBrush}"
                   HorizontalAlignment="Center"
                   Margin="0,25,0,0"
                   TextWrapping="Wrap"
                   MaxWidth="450"
                   TextAlignment="Center"/>
      </StackPanel>
    </Border>
  </Grid>
</Window>
